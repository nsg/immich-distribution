#!/bin/bash

export LD_LIBRARY_PATH="$SNAP/usr/local/pgsql/lib:$LD_LIBRARY_PATH"

export LC_ALL="C"
export LC_CTYPE="C"

export DB_HOSTNAME="127.0.0.1"
export DB_USERNAME="postgres"
export DB_PASSWORD="$(snapctl get database-password)"
export DB_DATABASE_NAME="immich"

export REDIS_HOSTNAME="127.0.0.1"
export REVERSE_GEOCODING_PRECISION="3"

drop_privileges() {
    $SNAP/usr/bin/setpriv \
        --clear-groups \
        --reuid snap_daemon \
        --regid snap_daemon \
        -- $@
}
